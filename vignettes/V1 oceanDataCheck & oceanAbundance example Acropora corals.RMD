---
tittle: Exploring Acropora corals abundance using from GBIF and OBIS data
author: I. Montero-Serra
date: 30/Jul/2018
output: html_document
---

# Introduction

This document describes how to use rOceans for computing abundance spatial patterns of abundance in marine species using raw data directly downloaded from OBIS and GBIF. Here we have an example of usage for scleractinian corals of the genus Acropora. 


(1) Download rOceans from GitHub and load the package

```{r, results = "hide", warning = FALSE,  message = FALSE}

library(rOceans)

```

## Function 2 *oceanDataCheck* 
Allows merging, checking, filtering the raw data from OBIS and/or GBIF into a common standard database. It removes occurrences with inconsistent or inconmplete taxonomic information, land-based occurrences, and duplicate occurrences. 

For this set of functions, we first  need to access and download data from GBIF (www.gbif.org) and OBIS (www.iobis.org). 

Here I show an example with data of species within the genus *Acropora* that were directly downloaded from the website on June 2018. The data can be accessed from my GitHub repository "monteroserra/rOceanData" or using data()

```{r}
#Accesing raw datasets
data(Acropora_GBIF) 
data(Acropora_OBIS)

#Checking OBIS or GBIF individually
Acropora_OBIS_checked = oceanDataCheck(OBIS_occurrences = Acropora_OBIS, source = "OBIS")

Acropora_GBIF_checked = oceanDataCheck(GBIF_occurrences = Acropora_GBIF, source = "GBIF")
```

Merging OBIS and GBIF Datasets, and checking for taxonomic and geographic issues
```{r}
Acropora_Total_Checked = oceanDataCheck(GBIF_occurrences = Acropora_GBIF,
                                        OBIS_occurrences = Acropora_OBIS,
                                        source = "GBIF_&_OBIS")
```

# Functions for analyzing and visualizing spatial trends in marine biodiversity

## Function 3 *oceanAbundance* 
Allows creating global or delimited spatial grids with abundance of occurrences per cell at differenc cell sizes. 

Following with the Acropora example, we will use this function to compute global rasters of abundance per grid cell for Acropora species at different resolutions (10 x 10?) (5 x 5?) (1? x 1?) and (0.5 x 0.0?) using *cell_size*

```{r}
Acropora_abundance_10x10 = oceanAbundance(occurrences = Acropora_Total_Checked, cell_size=10)
Acropora_abundance_5x5 = oceanAbundance(occurrences = Acropora_Total_Checked, cell_size=5)
Acropora_abundance_1x1 = oceanAbundance(occurrences = Acropora_Total_Checked, cell_size=1)
Acropora_abundance_0.5x0.5 = oceanAbundance(occurrences = Acropora_Total_Checked, cell_size=0.5)
```

## Function 4 *oceanMaps*  
A versatile data mapping tool for a rapid visualization of marine biodiversity patterns previously computed.  
```{r}
par(mfrow=c(2,2))
oceanMaps(Acropora_abundance_10x10, logScale=T, main="Acropora abundance (10x10)")
oceanMaps(Acropora_abundance_5x5, logScale=T, main="Acropora abundance (5x5)")
oceanMaps(Acropora_abundance_1x1, logScale=T, main="Acropora abundance (1x1)")
oceanMaps(Acropora_abundance_0.5x0.5, logScale=T, main="Acropora abundance (0.5x0.5)")
par(mfrow=c(1,1))

```
